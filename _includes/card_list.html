<ul class="horizontal-list">
  {% for item in include.collection %}
    {% assign item_id = item.slug | default: item.title | slugify %}

    <li class="card" 
        role="button" 
        tabindex="0"
        onclick="openModal('modal-{{ item_id }}')"
        onkeypress="if(event.key==='Enter') openModal('modal-{{ item_id }}')">

      <div class="card-inner">
        <span class="header">
          
          {{ item.title }}
          {% if item.highlight %}
            <mark>{{ item.highlight }}</mark>
          {% endif %}
          
        </span>
        
        <hr />
        
        {% if item.desc %}
        <p class="body">{{ item.desc }}</p>
        {% endif %}
        
      </div>
    </li>
  {% endfor %}
</ul>


<!-- Modals -->
{% for item in include.collection %}
  {% assign item_id = item.slug | default: item.title | slugify %}

  <div id="modal-{{ item_id }}" class="modal" aria-hidden="true">
    
    <div class="modal-backdrop" onclick="closeModal('modal-{{ item_id }}')"></div>

    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('modal-{{ item_id }}')">&times;</button>

      <h2>{{ item.title }}</h2>

      {% if item.desc %}
      <h3>{{ item.desc }}</h3>
      {% endif %}
      <!-- SLIDER -->
      <div class="modal-slides" data-active-slide="0">
      
        {% if item.slide_1 %}
        <div class="slide">{{ item.slide_1 | markdownify }}</div>
        {% endif %}
      
        {% if item.slide_2 %}
        <div class="slide">{{ item.slide_2 | markdownify }}</div>
        {% endif %}
      
        {% if item.slide_3 %}
        <div class="slide">{{ item.slide_3 | markdownify }}</div>
        {% endif %}
      
        <button class="slide-prev" onclick="prevSlide(this)">‹</button>
        <button class="slide-next" onclick="nextSlide(this)">›</button>
      
      </div>
      <!-- END SLIDER -->
      {% if item.external_link %}
      <p>
        <a class="button" href="{{ item.external_link }}" target="_blank">
          Deliverable
        </a>
      </p>
      {% endif %}

    </div>
  </div>
{% endfor %}

<script>
function openModal(id) {
  const m = document.getElementById(id);
  if (m) m.setAttribute('aria-hidden', 'false');
}

function closeModal(id) {
  const m = document.getElementById(id);
  if (m) m.setAttribute('aria-hidden', 'true');
}
</script>

<script>
function nextSlide(btn) {
  const container = btn.parentElement;
  const slides = container.querySelectorAll('.slide');
  let index = parseInt(container.dataset.activeSlide);

  index = (index + 1) % slides.length;

  container.dataset.activeSlide = index;
  updateSlides(container, slides, index);
}

function prevSlide(btn) {
  const container = btn.parentElement;
  const slides = container.querySelectorAll('.slide');
  let index = parseInt(container.dataset.activeSlide);

  index = (index - 1 + slides.length) % slides.length;

  container.dataset.activeSlide = index;
  updateSlides(container, slides, index);
}

function updateSlides(container, slides, index) {
  slides.forEach((s, i) => {
    s.style.display = i === index ? 'block' : 'none';
  });
}

document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".modal-slides").forEach(container => {
    const slides = container.querySelectorAll('.slide');
    updateSlides(container, slides, 0);
  });
});
</script>

